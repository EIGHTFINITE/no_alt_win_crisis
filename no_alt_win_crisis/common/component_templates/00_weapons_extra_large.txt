# ####################
# Energy Lance
# ####################

# ## Energy Lance 1
weapon_component_template = {
	key = "ENERGY_LANCE_1"
	size = extra_large
	type = instant

	icon = "GFX_ship_part_energy_lance_1"
	icon_frame = 1

	firing_arc = 25.0
	use_ship_main_target = no
	potential = {
		from = {
			country_uses_bio_ships = no
		}
	}

	show_tech_unlock_if = {
		country_uses_bio_ships = no
	}
	prerequisites = { "tech_energy_lance_1" }
	component_set = "ENERGY_LANCE_1"
	projectile_gfx = "particle_lance"
	tags = { weapon_type_energy weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery}
	ai_tag_weight = 0
	upgrades_to = "ENERGY_LANCE_2"
	resources = {
		category = ship_components
		cost = {
			alloys = @xl_t5_cost
			rare_crystals = @xl_t5_rare
		}
		upkeep = {
			alloys = @xl_t5_upkeep_alloys
			energy = @xl_t5_upkeep_energy
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ## Energy Lance 2
weapon_component_template = {
	key = "ENERGY_LANCE_2"
	size = extra_large
	type = instant

	icon = "GFX_ship_part_energy_lance_2"
	icon_frame = 1

	firing_arc = 25.0
	use_ship_main_target = no
	potential = {
		from = {
			country_uses_bio_ships = no
		}
	}

	show_tech_unlock_if = {
		country_uses_bio_ships = no
	}
	prerequisites = { "tech_energy_lance_2" }
	component_set = "ENERGY_LANCE_2"
	projectile_gfx = "tachyon_lance"
	tags = { weapon_type_energy weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery }
	ai_tag_weight = 0
	resources = {
		category = ship_components
		cost = {
			alloys = @xl_t6_cost
			rare_crystals = @xl_t6_rare
		}
		upkeep = {
			alloys = @xl_t6_upkeep_alloys
			energy = @xl_t6_upkeep_energy
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ####################
# Arc Emitter
# ####################

# ## Arc Emitter 1
weapon_component_template = {
	key = "ARC_EMITTER_1"
	size = extra_large
	type = instant

	icon = "GFX_ship_part_arc_emitter_1"
	icon_frame = 1

	firing_arc = 35.0
	min_range = 10.0
	use_ship_main_target = no
	potential = {
		from = {
			country_uses_bio_ships = no
		}
	}

	show_tech_unlock_if = {
		country_uses_bio_ships = no
	}
	prerequisites = { "tech_arc_emitter_1" }
	component_set = "ARC_EMITTER_1"
	projectile_gfx = "arc_emitter"
	tags = { weapon_type_energy weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery }
	ai_tag_weight = 0
	upgrades_to = "ARC_EMITTER_2"
	resources = {
		category = ship_components
		cost = {
			alloys = @xl_t5_cost
			rare_crystals = @xl_t5_rare
		}
		upkeep = {
			alloys = @xl_t5_upkeep_alloys
			energy = @xl_t5_upkeep_energy
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ## Arc Emitter 2
weapon_component_template = {
	key = "ARC_EMITTER_2"
	size = extra_large
	type = instant

	icon = "GFX_ship_part_arc_emitter_2"
	icon_frame = 1
	potential = {
		from = {
			country_uses_bio_ships = no
		}
	}

	show_tech_unlock_if = {
		country_uses_bio_ships = no
	}
	firing_arc = 35.0
	min_range = 10.0
	use_ship_main_target = no

	prerequisites = { "tech_arc_emitter_2" }
	component_set = "ARC_EMITTER_2"
	projectile_gfx = "focused_arc_emitter"
	tags = { weapon_type_energy weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery }
	ai_tag_weight = 0
	resources = {
		category = ship_components
		cost = {
			alloys = @xl_t6_cost
			rare_crystals = @xl_t6_rare
		}
		upkeep = {
			alloys = @xl_t6_upkeep_alloys
			energy = @xl_t6_upkeep_energy
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ####################
# Mass Accelerator
# ####################

# ## Mass Accelerator 1
weapon_component_template = {
	type = instant

	key = "MASS_ACCELERATOR_1"
	size = extra_large

	icon = "GFX_ship_part_mass_accelerator_1"
	icon_frame = 1

	firing_arc = 25.0
	min_range = 45.0
	use_ship_main_target = no

	prerequisites = { "tech_mass_accelerator_1" }
	potential = {
		from = {
			country_uses_bio_ships = no
		}
	}

	show_tech_unlock_if = {
		country_uses_bio_ships = no
	}
	component_set = "MASS_ACCELERATOR_1"
	projectile_gfx = "kinetic_artillery"
	tags = { weapon_type_kinetic weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery }
	ai_tag_weight = 0
	upgrades_to = "MASS_ACCELERATOR_2"
	resources = {
		category = ship_components
		cost = {
			alloys = @xl_t5_cost
			volatile_motes = @xl_t5_rare
		}
		upkeep = {
			energy = @xl_t5_upkeep_energy
			alloys = @xl_t5_upkeep_alloys
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = volatile_motes }
		}
		modifier = {
			factor = @cosmic_storm_shroud_ai_weight_factor
			has_country_flag = affected_by_shroud_storm
		}
		modifier = {
			factor = @cosmic_storm_gravity_ai_weight_factor
			has_country_flag = affected_by_gravity_storm
		}
	}
}

# ## Mass Accelerator 2
weapon_component_template = {
	type = instant

	key = "MASS_ACCELERATOR_2"
	size = extra_large

	icon = "GFX_ship_part_mass_accelerator_2"
	icon_frame = 1

	firing_arc = 25.0
	min_range = 45.0
	use_ship_main_target = no

	prerequisites = { "tech_mass_accelerator_2" }
	potential = {
		from = {
			country_uses_bio_ships = no
		}
	}

	show_tech_unlock_if = {
		country_uses_bio_ships = no
	}
	component_set = "MASS_ACCELERATOR_2"
	projectile_gfx = "adv_kinetic_artillery"
	tags = { weapon_type_kinetic weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery }
	ai_tag_weight = 0
	resources = {
		category = ship_components
		cost = {
			alloys = @xl_t6_cost
			volatile_motes = @xl_t6_rare
		}
		upkeep = {
			energy = @xl_t6_upkeep_energy
			alloys = @xl_t6_upkeep_alloys
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = volatile_motes }
		}
		modifier = {
			factor = @cosmic_storm_shroud_ai_weight_factor
			has_country_flag = affected_by_shroud_storm
		}
		modifier = {
			factor = @cosmic_storm_gravity_ai_weight_factor
			has_country_flag = affected_by_gravity_storm
		}
	}
}

# ####################
# Titan Laser
# ####################

# ## Perdition Beam
weapon_component_template = {
	key = "PERDITION_BEAM_TITAN"
	size = titanic
	type = instant
	prio_projectile = yes

	icon = "GFX_ship_part_perdition_beam"
	icon_frame = 1

#	firing_arc = 10.0
	use_ship_main_target = no

	tags = { weapon_type_energy weapon_role_artillery t_slot }
	prerequisites = { "tech_titans" }
	component_set = "PERDITION_BEAM"
	projectile_gfx = "perdition_beam"
	potential = {
		ship_uses_titan_components = yes
	}
	resources = {
		category = ship_components
		cost = {
			alloys = @titanic_t6_cost
			rare_crystals = @titanic_t6_rare
		}
		upkeep = {
			alloys = @titanic_t6_upkeep_alloys
		}
		upkeep = {
			trigger = {
				from = {
					country_uses_bio_ships = no
				}
			}
			energy = @titanic_t6_upkeep_energy
		}
		upkeep = {
			trigger = {
				from = {
					country_uses_bio_ships = yes
				}
			}
			food = @titanic_t6_upkeep_energy
		}
	}

	on_hit = {
		inline_script = {
			script = ship_components/collateral_damage
			RANGE = @perdition_beam_collateral_range
			DAMAGE = @perdition_beam_fleet_damage
		}
		custom_tooltip = "PERDITION_BEAM_FLEET_EFFECT"
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ## Perdition Beam
weapon_component_template = {
	key = "PERDITION_BEAM_ION"
	size = titanic
	type = instant
	prio_projectile = yes

	icon = "GFX_ship_part_perdition_beam"
	icon_frame = 1

#	firing_arc = 10.0
	use_ship_main_target = no

	tags = { weapon_type_energy weapon_role_artillery t_slot }

	prerequisites = { "tech_titans" }
	component_set = "PERDITION_BEAM"
	projectile_gfx = "ion_cannon"
	potential = {
		OR = {
			ship_uses_ion_cannon_components = yes
			ship_uses_dsc_components = yes
		}
	}
	resources = {
		category = ship_components
		cost = {
			alloys = @titanic_t6_cost
			rare_crystals = @titanic_t6_rare
		}
		upkeep = {
			alloys = @titanic_t6_upkeep_alloys
		}
		upkeep = {
			trigger = {
				from = {
					country_uses_bio_ships = no
				}
			}
			energy = @titanic_t6_upkeep_energy
		}
		upkeep = {
			trigger = {
				from = {
					country_uses_bio_ships = yes
				}
			}
			food = @titanic_t6_upkeep_energy
		}
	}

	on_hit = {
		inline_script = {
			script = ship_components/collateral_damage
			RANGE = @ion_cannon_collateral_range
			DAMAGE = @ion_cannon_collateral_range
		}
		custom_tooltip = "ION_CANNON_FLEET_EFFECT"
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ## Titan Lance
weapon_component_template = {
	key = "TITAN_LASER"
	size = titanic
	type = instant
	prio_projectile = yes

	hidden = yes

	icon = "GFX_ship_part_energy_lance_2"
	icon_frame = 1

#	firing_arc = 25.0
	use_ship_main_target = no

	tags = { weapon_type_energy weapon_role_artillery t_slot }

	component_set = "TITAN_LASER"
	projectile_gfx = "titan_laser"
	resources = {
		category = ship_components
		cost = {
			alloys = @titanic_t6_cost
			rare_crystals = @titanic_t6_rare
		}
		upkeep = {
			energy = @titanic_t6_upkeep_energy
			alloys = @titanic_t6_upkeep_alloys
		}
	}

	on_hit = {
		inline_script = {
			script = ship_components/collateral_damage
			RANGE = @perdition_beam_collateral_range
			DAMAGE = @perdition_beam_fleet_damage
		}
		custom_tooltip = "PERDITION_BEAM_FLEET_EFFECT"
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = rare_crystals }
		}
	}
}

# ## Lens-Flare Beam
weapon_component_template = {
	key = "LENS_FLARE_BEAM"
	size = extra_large
	type = instant

	icon = "GFX_ship_part_energy_lens_beam"
	icon_frame = 1

	firing_arc = 25.0
	use_ship_main_target = no
	potential = {
		OR = {
			is_ship_size = ember_battleship
			is_ship_size = entropy_conduit
			is_ship_size = conduit_station
		}
	}

	component_set = "LENS_FLARE_BEAM"
	projectile_gfx = "lens_flare_beam"
	tags = { weapon_type_energy weapon_role_artillery x_slot }
	ai_tags = { weapon_role_artillery artillery }
	ai_tag_weight = 0

	on_hit = {
		custom_tooltip = "lfb_on_hit_stun_tt"
		hidden_effect = {
			if = {
				limit = {
					exists = this
					NOT = { has_ship_flag = conduit_paralyzed }
				}
				set_timed_ship_flag = { flag = conduit_paralyzed days = 35 }
				add_modifier = {
					modifier = lf_weapon_stun_effect
					days = 7 # If this changes, adjust the tt
				}
			}
			from.owner = { add_resource = { entropy_crystals = 1 } }
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}

	ai_weight = {
		weight = 1.25
		modifier = {
			factor = 0.0
			no_resource_for_component = { RESOURCE = entropy_crystals }
		}
	}
}

# Solarflare Emitter
weapon_component_template = {
	key = "SOLARFLARE_EMITTER"
	size = extra_large
	type = instant
	prio_projectile = yes

	icon = "GFX_ship_part_energy_lens_beam"
	icon_frame = 1

#	firing_arc = 10.0
	use_ship_main_target = no

	tags = { weapon_type_energy weapon_role_artillery x_slot }

	potential = { is_ship_size = starfire_cannon }
	component_set = "SOLARFLARE_EMITTER"
	projectile_gfx = "starfire_cannon"

	target_type = target_enemies
	target_focus = spread
	on_hit = {
		custom_tooltip = "sfe_on_hit_stun_tt"
		hidden_effect = {
			if = {
				limit = {
					exists = this
					NOT = { has_ship_flag = starfire_emp }
				}
				set_timed_ship_flag = { flag = starfire_emp days = 15 }
				add_modifier = {
					modifier = sfe_weapon_stun_effect
					days = 5 # If this changes, adjust the tt
				}
			}
		}
		inline_script = {
			script = ship_components/collateral_damage
			RANGE = @ion_cannon_collateral_range
			DAMAGE = @ion_cannon_collateral_range
		}
	}

	target_weights = {
		titan = 3
		battleship = 2
		stinger_stage_1 = 1.5
		stinger_stage_2 = 2
		stinger_stage_3 = 2
	}
}
